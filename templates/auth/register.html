{% extends "layouts/base.html" %}

{% block title %}Registro de Cliente - Rust-Eze{% endblock %}

{% block content %}
<div class="container">

  <!-- ==========================
       REGISTRO (칔NICA SECCI칍N)
       ========================== -->
  <section id="register-section" class="login-section">
    <div class="login-form-card card login-card-elevated">
      <div class="card-header login-card-header d-flex align-items-center justify-content-between flex-wrap gap-2">
        <div>
          <div class="rainbow-title mb-1 login-rainbow-title">RUST-EZE</div>
          <div class="login-subtitle">Registro de cliente 췅 Acceso al cat치logo</div>
        </div>
        <span class="badge rounded-pill login-secure-pill px-3 py-2">
          <i class="fas fa-id-card me-2"></i>游땙Nuevo cliente
        </span>
      </div>

      <div class="card-body p-4 p-md-5">

        {# mensajes flash #}
        {% with messages = get_flashed_messages(with_categories=true) %}
          {% if messages %}
            {% for category, message in messages %}
              <div class="alert alert-{{ category }} mb-2">{{ message }}</div>
            {% endfor %}
          {% endif %}
        {% endwith %}

        <form id="registerForm" method="POST" action="{{ url_for('auth.register') }}">

          <div class="mb-3">
            <label class="form-label">Nombre completo</label>
            <input type="text"
                   class="form-control form-control-lg input-elevated"
                   name="nombre_completo"
                   placeholder="Tu nombre y apellidos"
                   required>
          </div>

          <div class="mb-3">
            <label class="form-label">Email</label>
            <input type="email"
                   class="form-control form-control-lg input-elevated"
                   name="email"
                   placeholder="tu@email.com"
                   required>
          </div>

          <div class="mb-3">
            <label class="form-label">Tel칠fono</label>
            <input type="text"
                   class="form-control form-control-lg input-elevated"
                   name="telefono"
                   placeholder="Ej. 55 1234 5678"
                   required>
          </div>

          <div class="mb-3">
            <label class="form-label">Contrase침a</label>
            <input id="password"
                   type="password"
                   class="form-control form-control-lg input-elevated"
                   name="password"
                   placeholder="Crea una contrase침a segura"
                   required>
<small class="password-helper d-block mt-2">
  Debe tener al menos 8 caracteres, una may칰scula, un n칰mero y un car치cter especial (!@#$%&*).
</small>
          </div>

          <div class="mb-4">
            <label class="form-label">Confirmar contrase침a</label>
            <input id="confirmPassword"
                   type="password"
                   class="form-control form-control-lg input-elevated"
                   placeholder="Repite tu contrase침a"
                   required>
          </div>

          <button type="submit" class="btn btn-primary w-100 btn-login-lg login-cta-btn">
            <i class="fas fa-user-check me-2"></i> Crear cuenta
          </button>

          <div class="text-center mt-3">
            <span class="text-soft">쯏a tienes cuenta?</span>
            <a href="{{ url_for('auth.login') }}" class="ms-1 link-light fw-semibold small">
              Inicia sesi칩n
            </a>
          </div>

        </form>

        <div class="demo-credentials mt-4">
          <small class="demo-helper-text d-block mb-2">
            Tu cuenta se registrar치 como cliente y quedar치 lista para comprar veh칤culos disponibles.
          </small>
          <ul class="mb-0">
            <li class="text-soft">
              El sistema validar치 que el correo y el tel칠fono no est칠n registrados previamente.
            </li>
            <li class="text-soft">
              Se exige una contrase침a fuerte para proteger tu cuenta.
            </li>
          </ul>
        </div>

      </div>
    </div>
  </section>

</div>
{% endblock %}

{% block extra_js %}
<script>
  // Validaci칩n de contrase침a fuerte + coincidencia
  document.addEventListener('DOMContentLoaded', function () {
    const form = document.getElementById('registerForm');
    const pass = document.getElementById('password');
    const confirmPass = document.getElementById('confirmPassword');

    if (!form || !pass || !confirmPass) return;

    form.addEventListener('submit', function (e) {
      const pwd = pass.value || '';
      const strongRegex = /^(?=.*[A-Z])(?=.*\d)(?=.*[!@#$%&*]).{8,}$/;

      if (!strongRegex.test(pwd)) {
        e.preventDefault();
        alert('La contrase침a debe tener al menos 8 caracteres, una may칰scula, un n칰mero y un car치cter especial (!@#$%&*).');
        pass.focus();
        return;
      }

      if (pass.value !== confirmPass.value) {
        e.preventDefault();
        alert('Las contrase침as no coinciden.');
        confirmPass.focus();
      }
    });
  });
</script>

<style>
  /* ==========================
     MISMO ESTILO QUE EL LOGIN
     ========================== */
.password-helper {
  color: #ffffff;
  opacity: 0.95;
}

  .login-form-card {
    max-width: 720px;
    margin-top: 3rem;
    margin-bottom: 3rem;
  }

  .login-card-elevated {
    position: relative;
    overflow: hidden;
    border-radius: 1.9rem;
  }

  /* Borde animado tipo arco칤ris */
  .login-card-elevated::before {
    content: "";
    position: absolute;
    inset: -3px;
    border-radius: inherit;
    background: linear-gradient(
      120deg,
      #f97316,
      #eab308,
      #22c55e,
      #06b6d4,
      #6366f1,
      #ec4899,
      #f97316
    );
    background-size: 400% 400%;
    animation: rainbow-border 14s linear infinite;
    z-index: -2;
  }

  .login-card-elevated::after {
    content: "";
    position: absolute;
    inset: 2px;
    border-radius: inherit;
    background: rgba(15, 23, 42, 0.98);
    z-index: -1;
  }

  @keyframes rainbow-border {
    0%   { background-position:   0% 50%; }
    50%  { background-position: 100% 50%; }
    100% { background-position:   0% 50%; }
  }

  /* Header con degradado animado */
  .login-card-header {
    border-bottom: 1px solid rgba(15, 23, 42, 0.9);
    background: linear-gradient(
      120deg,
      #f97316,
      #eab308,
      #22c55e,
      #06b6d4,
      #6366f1,
      #ec4899,
      #f97316
    );
    background-size: 300% 300%;
    animation: rainbow-header 18s ease infinite;
    color: #f9fafb;
  }

  @keyframes rainbow-header {
    0%   { background-position:   0% 50%; }
    50%  { background-position: 100% 50%; }
    100% { background-position:   0% 50%; }
  }

  .login-secure-pill {
    background: rgba(15, 23, 42, 0.92);
    border: 1px solid rgba(248, 250, 252, 0.35);
    font-size: 0.8rem;
    text-transform: uppercase;
    letter-spacing: 0.08em;
  }

  .login-rainbow-title {
    font-size: 1.7rem;
    letter-spacing: 0.12em;
  }

  .login-card-elevated .form-control-lg,
  .login-card-elevated .form-select-lg {
    padding: 1rem 1.15rem;
    font-size: 1.02rem;
    border-radius: 0.9rem;
    box-shadow: inset 0 0 0 1px rgba(15, 23, 42, 0.9);
  }

  .login-card-elevated .form-control-lg:focus,
  .login-card-elevated .form-select-lg:focus {
    box-shadow:
      0 0 0 0.14rem rgba(56, 189, 248, 0.45),
      0 16px 32px rgba(15, 23, 42, 0.95);
  }

  .login-cta-btn {
    position: relative;
    overflow: hidden;
    font-size: 1.05rem;
    padding-top: 0.95rem;
    padding-bottom: 0.95rem;
  }

  .login-cta-btn::after {
    content: "";
    position: absolute;
    inset: 0;
    border-radius: inherit;
    background: radial-gradient(circle at 10% 0%, rgba(251, 191, 36, 0.32), transparent 55%);
    opacity: 0;
    transition: opacity 0.25s ease-out;
  }

  .login-cta-btn:hover::after {
    opacity: 1;
  }

  /* Texto informativo un poco m치s claro */
  .demo-helper-text {
    color: #cbd5ff;
  }
</style>
{% endblock %}
