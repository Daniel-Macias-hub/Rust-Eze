{% extends "layouts/base.html" %}
{% block title %}Detalle de venta #{{ venta.venta_id }} - Rust-Eze{% endblock %}

{% block content %}
<div class="container py-4">

  <h2 class="mb-3">Detalle de venta #{{ venta.venta_id }}</h2>

  <div class="row g-3">
    <!-- Datos generales -->
    <div class="col-md-6">
      <div class="card h-100">
        <div class="card-header">
          Información de la venta
        </div>
        <div class="card-body">
          <p><strong>Fecha:</strong> {{ venta.fecha_venta }}</p>
          <p><strong>Total:</strong> {{ format_currency(venta.total_venta) }}</p>
          <p><strong>Método de pago:</strong> {{ venta.metodo__pago or venta.metodo_pago }}</p>
          <p><strong>Estado:</strong> {{ venta.estado_venta }}</p>
        </div>
      </div>
    </div>

    <!-- Cliente y empleado -->
    <div class="col-md-6">
      <div class="card mb-3">
        <div class="card-header">Cliente</div>
        <div class="card-body">
          <p><strong>Nombre:</strong> {{ venta.cliente }}</p>
          <p><strong>Email:</strong> {{ venta.cliente_email }}</p>
        </div>
      </div>

      <div class="card">
        <div class="card-header">Empleado</div>
        <div class="card-body">
          <p><strong>Nombre:</strong> {{ venta.empleado }}</p>
          <p><strong>Email:</strong> {{ venta.empleado_email }}</p>
        </div>
      </div>
    </div>
  </div>

  <!-- Vehículo -->
  <div class="card mt-4">
    <div class="card-header">
      Vehículo
    </div>
    <div class="card-body">
      <p>
        <strong>Modelo:</strong>
        {{ venta.marca }} {{ venta.modelo }} ({{ venta.anio }})
      </p>
      <p><strong>Color:</strong> {{ venta.color }}</p>
      <p><strong>Tipo:</strong> {{ venta.tipo }}</p>
    </div>
  </div>

  <div class="mt-4 d-flex justify-content-between">
    <a href="{{ url_for('admin.ventas_list') }}" class="btn btn-secondary">
      Volver al listado de ventas
    </a>

    {% if venta.estado_venta == 'Activa' %}
      <form action="{{ url_for('admin.ventas_cancelar', venta_id=venta.venta_id) }}"
            method="post"
            onsubmit="return confirm('¿Seguro que deseas cancelar esta venta?');">
        <button type="submit" class="btn btn-danger">
          Cancelar venta
        </button>
      </form>
    {% endif %}
  </div>

</div>
{% endblock %}
