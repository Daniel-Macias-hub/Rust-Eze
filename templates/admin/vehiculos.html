<script>
// Funci√≥n para hacer llamadas API (FALTABA ESTA DEFINICI√ìN)
async function apiCall(url, data) {
    try {
        const response = await fetch(url, {
            method: 'POST',
            headers: {
                'Content-Type': 'application/json',
            },
            body: JSON.stringify(data)
        });
        return await response.json();
    } catch (error) {
        console.error('Error en apiCall:', error);
        throw error;
    }
}

// Funci√≥n para mostrar notificaciones (FALTABA ESTA DEFINICI√ìN)
function showNotification(message, type = 'info') {
    // Crear elemento de notificaci√≥n
    const notification = document.createElement('div');
    notification.className = `alert alert-${type === 'error' ? 'danger' : type} alert-dismissible fade show position-fixed`;
    notification.style.cssText = 'top: 20px; right: 20px; z-index: 9999; min-width: 300px;';
    notification.innerHTML = `
        ${message}
        <button type="button" class="btn-close" data-bs-dismiss="alert"></button>
    `;
    
    document.body.appendChild(notification);
    
    // Auto-eliminar despu√©s de 5 segundos
    setTimeout(() => {
        if (notification.parentNode) {
            notification.remove();
        }
    }, 5000);
}

// Funci√≥n para agregar veh√≠culo
async function agregarVehiculo() {
    const form = document.getElementById('formAgregarVehiculo');
    const formData = new FormData(form);
    
    // Convertir FormData a objeto simple
    const data = {};
    for (let [key, value] of formData.entries()) {
        data[key] = value;
    }
    
    // Validaci√≥n b√°sica
    if (!data.marca || !data.modelo || !data.precio) {
        alert('Por favor complete todos los campos requeridos.');
        return;
    }
    
    try {
        const result = await apiCall('/admin/api/agregar-vehiculo', data);
        
        if (result.success) {
            showNotification('‚úÖ ' + result.message, 'success');
            
            // Cerrar modal usando Bootstrap JavaScript
            const modalElement = document.getElementById('agregarVehiculoModal');
            const modal = bootstrap.Modal.getInstance(modalElement);
            modal.hide();
            
            form.reset();
            
            // Recargar la p√°gina despu√©s de 1 segundo
            setTimeout(function() {
                location.reload();
            }, 1000);
        } else {
            showNotification('‚ùå ' + result.message, 'error');
        }
    } catch (error) {
        showNotification('‚ùå Error de conexi√≥n', 'error');
    }
}

// Funci√≥n para editar veh√≠culo
function editarVehiculo(id) {
    showNotification('‚úèÔ∏è Funcionalidad de edici√≥n en desarrollo', 'info');
}

// Funci√≥n para ver detalles
function verDetalles(id) {
    showNotification('üëÅÔ∏è Funcionalidad de detalles en desarrollo', 'info');
}

// Funci√≥n para eliminar veh√≠culo
function eliminarVehiculo(id) {
    if (confirm('¬øEst√°s seguro de que quieres eliminar este veh√≠culo? Esta acci√≥n no se puede deshacer.')) {
        showNotification('üóëÔ∏è Funcionalidad de eliminaci√≥n en desarrollo', 'info');
    }
}
</script>